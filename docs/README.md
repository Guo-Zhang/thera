# `thera`：苹果的外脑系统

## 动机

推演半自传体小说剧情有较大的推理和记忆工作量，希望使用这个外脑系统帮助我从这些事务脱身专注于创造。

AI辅助的外接大脑帮助深度思考。
我写这个项目的动机是写小说的时候发现推理工作量比较大。
目前困扰我的主要问题是要保证小说逻辑内部的一致性。
首先就要能够把关键信息分门别类地存起来，然后要能够在推理和检查剧情时充分使用这些信息获得一致性。
以现实为原型写半自传体。所以我需要区分现实、虚构，以及建立现实到虚构的映射，并且要维护虚实之间的桥梁。


## 特性

- 编辑：可交互式提交知识
- 查看：可查看现有知识
- 批量导入：支持从dev_docs目录批量导入文档作为知识图谱中的Episodes

### 提交知识

用户在对话中输入一个原始想法：

```
我想写一个以滁州为原型的小说，在小说中以滁州的别名亭城为名，实际写作的时候增加很多虚构。
```

调用大模型 API 处理成知识图谱：

```
现实：滁州
虚构：亭城
关系：原型
```

以及定义映射关系：
```
# 映射关系：现实地点 映射_to 虚构地点
映射_to(maps_to)         
```

## 架构

### 分层

用户界面层：提供人与AI交互维护KG的页面。
应用层：调用大模型API处理原始信息并存入图数据库。
基础设施层：大模型API、图数据库等。

### 文档导入架构

当使用 `import_docs` 命令或运行 `scripts/import_dev_docs.py` 脚本时，系统会执行以下流程将文档导入知识图谱：

1. 扫描 `dev_docs` 目录及其子目录中的所有 Markdown (.md) 文件
2. 对每个文件创建一个独立的 Episode
3. 使用 DocsImporter 类将文件内容作为知识添加到 Graphiti 知识图谱中
4. 每个 Episode 包含以下信息：
   - 名称：文件名（不含扩展名）
   - 内容：完整的文件内容，加上分类和文件元数据
   - 分类：基于文件在 `dev_docs` 目录中的相对路径
   - 源描述：文档导入路径
   - 引用时间：导入操作的时间戳

此批量导入功能支持通过 CLI 命令 `import_docs` 和 `list_docs` 进行交互式管理。
